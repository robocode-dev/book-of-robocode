<svg xmlns="http://www.w3.org/2000/svg" width="600" height="400" viewBox="0 0 1000 1000">

    <use href="#coordinate-system" x="0" y="0" />
    <use href="#tank" x="2000" y="2000" transform="scale(.2)"/>

    <defs>
        <!-- Grid pattern (10x10 cells) -->
        <pattern id="gridPattern" x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse">
            <line x1="10" y1="0" x2="10" y2="10" stroke="#e5e7eb" stroke-width="1" />
            <line x1="0" y1="10" x2="10" y2="10" stroke="#e5e7eb" stroke-width="1" />
        </pattern>

        <!-- Arrowhead marker -->
        <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
            <path d="M 0 0 L 10 5 L 0 10 z" fill="#111827" />
        </marker>

        <!-- Coordinate system symbol: reference with <use href="#coordinate-system" /> -->
        <symbol id="coordinate-system" viewBox="0 0 600 400">
            <!-- Background -->
            <rect x="0" y="0" width="600" height="400" fill="#ffffff" />

            <!-- Battlefield area with grid fill -->
            <rect x="50" y="20" width="500" height="330" fill="url(#gridPattern)" />

            <!-- Battlefield border: only left and bottom (no top, no right) -->
            <line x1="50" y1="350" x2="550" y2="350" stroke="#111827" stroke-width="2" />
            <line x1="50" y1="20" x2="50" y2="350" stroke="#111827" stroke-width="2" />

            <!-- Axes -->
            <line x1="50" y1="350" x2="580" y2="350" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
            <line x1="50" y1="350" x2="50" y2="10" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />

            <!-- Origin label -->
            <circle cx="50" cy="350" r="3" fill="#ef4444" />
            <text x="58" y="345" font-family="sans-serif" font-size="12" fill="#111827">(0, 0)</text>

            <!-- Axis labels -->
            <text x="580" y="365" font-family="sans-serif" font-size="12" text-anchor="end" fill="#111827">X (right)</text>
            <text x="40" y="15" font-family="sans-serif" font-size="12" text-anchor="end" fill="#111827">Y (up)</text>

            <!-- Title / caption -->
            <text x="300" y="390" font-family="sans-serif" font-size="14" text-anchor="middle" fill="#4b5563">
                Battlefield coordinate system: origin at bottom-left
            </text>
        </symbol>
    </defs>

    <defs>
        <symbol id="link0">
            <rect x="5" y="55" width="125" height="25" fill="#aaaaaa"/>
            <rect x="10" y="70" width="116" height="35" fill="#666666" rx="10" ry="10"/>
            <rect x="5" y="55" width="125" height="50" fill="none" stroke="black" stroke-width="10" rx="10" ry="10"/>
        </symbol>

        <symbol id="link30">
            <rect x="5" y="55" width="125" height="25" fill="#939393"/>
            <rect x="10" y="70" width="116" height="30" fill="#585858" rx="10" ry="10"/>
            <rect x="5" y="55" width="125" height="42" fill="none" stroke="black" stroke-width="10" rx="10" ry="10"/>
        </symbol>

        <symbol id="link60">
            <rect x="5" y="55" width="125" height="20" fill="#555555"/>
            <rect x="5" y="55" width="125" height="20" fill="none" stroke="black" stroke-width="10" rx="10" ry="10"/>
        </symbol>

        <symbol id="main-track">
            <rect x="20" y="75" width="95" height="450" fill="#333333" stroke="black" stroke-width="10"/>
        </symbol>

        <symbol id="track2">
            <use href="#main-track" x="0" y="0"/>
            <use href="#link60" x="0" y="0"/>
            <use href="#link0" x="0" y="33"/>
            <use href="#link0" x="0" y="113"/>
            <use href="#link0" x="0" y="193"/>
            <use href="#link0" x="0" y="273"/>
            <use href="#link0" x="0" y="353"/>
            <use href="#link0" x="0" y="433"/>
        </symbol>

        <symbol id="track3">
            <use href="#main-track" x="0" y="0"/>
            <use href="#link0" x="0" y="7"/>
            <use href="#link0" x="0" y="87"/>
            <use href="#link0" x="0" y="167"/>
            <use href="#link0" x="0" y="247"/>
            <use href="#link0" x="0" y="327"/>
            <use href="#link0" x="0" y="407"/>
            <use href="#link60" x="0" y="470"/>
        </symbol>

        <symbol id="body">
            <use href="#track2" x="150" y="100"/>
            <use href="#track3" x="515" y="100"/>

            <rect x="240" y="190" width="320" height="420" fill="#019" stroke="black" stroke-width="20" rx="10"
                  ry="10"/>
            <rect x="250" y="520" width="300" height="80" fill="black" opacity="0.5"/>
        </symbol>

        <symbol id="turret">
            <rect x="300" y="320" width="200" height="200" fill="#06C" stroke="black" stroke-width="20" rx="10"
                  ry="10"/>
            <rect x="310" y="460" width="180" height="50" fill="black" opacity="0.5"/>

            <rect x="360" y="240" width="80" height="80" fill="url(#cannon-grad)" stroke="black" stroke-width="20"/>
            <rect x="375" y="70" width="50" height="170" fill="url(#cannon-grad)" stroke="black" stroke-width="20"/>

            <linearGradient id="cannon-grad" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" stop-color="#333"/>
                <stop offset="50%" stop-color="#CCC"/>
                <stop offset="100%" stop-color="#333"/>
            </linearGradient>
        </symbol>

        <symbol id="radar">
            <circle cx="400" cy="400" r="30" fill="#AAF" stroke="black" stroke-width="20"/>
            <path d="M 290 420 q 110 100 220 0 z" fill="#AAF" stroke="black" stroke-width="20"/>
        </symbol>

        <symbol id="tank">
            <use href="#body" transform="rotate(54,400,400)"/>
            <use href="#turret" transform="rotate(77,400,400)"/>
            <use href="#radar" transform="rotate(421,400,400)"/>
        </symbol>

        <defs>
            <linearGradient id="sweepGrad" gradientUnits="userSpaceOnUse" x1="0" y1="0" x2="0" y2="1000">
                <stop offset="0%" stop-color="green" stop-opacity="0.8"/>
                <stop offset="50%" stop-color="green" stop-opacity="0.1"/>
                <stop offset="100%" stop-color="green" stop-opacity="0"/>
            </linearGradient>

            <clipPath id="sector">
                <path d="
                    M 400 400
                    L 3000 0
                    A -1500 -1500 0 0 1 3000 1000
                    Z"/>
            </clipPath>
        </defs>

        <symbol id="arrows-with-text">
            <marker id="arrow-head" markerWidth="20" markerHeight="20" refX="6" refY="3" orient="auto">
                <polygon points="6 0, 12 3, 6 6" fill="#8F8B"/>
            </marker>
            <line x1="400" y1="700" x2="3000" y2="295" stroke="#8F8B" stroke-width="10" marker-end="url(#arrow-head)"/>

            <text x="800" y="690" class="text" fill="#8F8B" transform="rotate(-9)">Previous and current Heading (beam)</text>
        </symbol>
    </defs>

</svg>
